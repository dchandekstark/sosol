- if @current_user
  .welcome
    %p
      %em Welcome Back
      %br
      @current_user.name
    %nav
      .news
  %nav.links
    = link_to 'home', dashboard_url
    = link_to 'account', account_url
    = link_to 'about', 'http://sites.tufts.edu/perseids', :onclick => "window.open(this.href);return false;"
    = link_to 'sign out', signout_url

    - community_ids = @current_user.boards.collect{ |b| b.community_id }
    - community_ids.uniq!
    - community_ids.compact!

    - if community_ids.length > 0
      - current_board_id  = nil
      - if @current_board
        - current_board_id = @current_board.id

      %a{:onclick=>"showBoardDialog(event)",  :id=>"board_menu", :class=>"editor_menu"}
      %nav
        - community_ids.each do |next_id|
          - community_boards = @current_user.boards.ranked_by_community_id(next_id)
          - current_name = Community.find(next_id).friendly_name
          = current_name
          %nav
            - community_boards.each do |cb|
              = link_to cb.friendly_name, :controller => "user", :action => "dashboard", :dashboard_type => "board", :board_id => cb.id
    - if @current_user.admin
      = link_to 'Boards', boards_url
      = link_to 'Edit Text Leiden+ Help', docos_url(:docotype => "text")
      = link_to 'Edit Translation Leiden+ Help', docos_url(:docotype => "translation")
      = link_to 'Email Users', sendmsg_url
    - if @current_user.developer
      = link_to 'developer', developer_url
    - if @current_user.is_community_master_admin
      = link_to "Community", :controller => "communities"

- elsif (controller.action_name != 'consume' && controller.action_name != 'signin')
  #signin
    = link_to 'Sign In', signin_url
