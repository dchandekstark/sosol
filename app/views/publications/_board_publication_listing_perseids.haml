- if defined?(list_name)
  - list_id = "publication_list_holder_" + list_name
- else
  - list_id = "publication_list_holder"
%div{:class => "publication-column", :id => list_id, "data-type" => 'list_name' }
  - publications.each do |publication|
    %div{:class => 'publication'}
      - display_title = publication.title
      %ul{:class => 'publication-items'}
        - Identifier.site_identifier_classes.each do |i|
          - if i.constantize::is_visible
            - publication.identifiers.each do |m|
              - if m.type == i
                %li{:class => m.class}
                  %span{:class => 'type-legend'}
                    = m.class::FRIENDLY_NAME
                  = link_to m.title, edit_polymorphic_path([publication,m])
      %span{:class => "legend"}
        %span{:class => "alt-title"}
        = link_to display_title, publication, :title => "Last modified #{time_ago_in_words(publication.updated_at)} ago. Submitted by " + publication.creator.name, :class => "original"
        - if list_name == "approved"
          - if publication.find_finalizer_user
            - finalizer_div_id = "finalizer_" + publication.id.to_s
            %br
            = publication.find_finalizer_user.human_name
            = " is finalizing. "
            = button_to "Make me finalizer.", { :controller=>'publications', :action=>'become_finalizer', :id=>publication.id, :onclick => 'this.disabled=true;return true;' }
        - if list_name == "needs_review" || list_name == "waiting"
          - if publication.votes.count > 0
            %div{:class=>"votes dropdown-container"}
              %ul{:class => "type-dropdown"}
                %li{:class => "active votes"}
                  = publication.votes.count
                  = publication.votes.count == 1 ? " vote" : " votes"
                - publication.votes.each do |vote|
                  %li{:class => "votes"}
                    = vote.user.human_name + " (" + vote.user.name + ") "
                    = vote.choice
:javascript
  jQuery(document).ready(
    function() { perseids_publication_selector(); });
